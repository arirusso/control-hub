#!/usr/bin/env ruby
$LOAD_PATH.unshift File.join(File.dirname(__FILE__), '..', 'lib')

require "optparse"
require "patch"

network_config = ARGV.first
options = {}

args = OptionParser.new do |opts|
  opts.banner = "Usage: patch [io config file] [options]"

  opts.on("-a", "--action [FILE]", "Use action spec") do |file|
    options[:action] = file
  end
end

args.parse!

if network_config.nil?
  puts args.help
  exit 0
end

action = File.new(options[:action]) unless options[:action].nil?

hub = Patch.new(File.new(network_config), :action => action)
hub.listen
