#!/usr/bin/env ruby
$LOAD_PATH.unshift File.join(File.dirname(__FILE__), '..', 'lib')

require "optparse"
require "control-hub"

network_config = ARGV.first
options = {}

args = OptionParser.new do |opts|
  opts.banner = "Usage: control-hub [io config file] [options]"

  opts.on("-c", "--control [FILE]", "Use control spec") do |file|
    options[:control] = file
  end
end

args.parse!

if network_config.nil?
  puts args.help
  exit 0
end

control = File.new(options[:control]) unless options[:control].nil?

hub = ControlHub.new(:io => File.new(network_config), :control => control)
hub.listen
